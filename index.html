<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Offentligit : A website to compare Danish IT expenses." />

    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
    <script type="text/javascript" src="http://microajax.googlecode.com/files/microajax.minified.js"></script>

    <title>Offentlig IT</title>
  </head>

  <body class="container">

    <div class="page-header">
      <h1>Udgifter for st√∏rre offentlige IT projekter siden 2000</h1>
    </div>
  
    <div class="row">  
      <div class="col-md-3">
        <ul class="nav nav-stacked" id="menu">
          <li class="btn btn-primary">Alle IT projekter</li>
        </ul>
      </div>
      
      <div class="col-md-9 row" id="view">
        <div class="row">
          <div class="col-md-4"></div>
          <div class="col-md-8 scale"></div>
        </div>
      </div>
    
    </div>

    <!-- FOOTER  -->
    <hr>
    <footer class="inner">
        <p class="copyright">Offentlig IT maintained by <a href="https://github.com/Jegp">Jegp</a></p>
    </footer>
    
    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
        var pageTracker = _gat._getTracker("UA-51975552-1");
      pageTracker._trackPageview();
      } catch(err) {}
    </script>

    <script type="text/javascript">
      var data = (function() {
        var view = document.getElementById("view");
        var dataElement, projects, comparisons = {};
        
        var obj = {
          setProject: function(project) {
            console.log(project);
            while (view.hasChildNodes()) {
              view.removeChild(view.lastChild);
            }
          
            switch(project) {
              case -1:
                
              break;
              default:
                var cost = projects[project].amount
                for (i in comparisons) {
                  var e = dataElement.cloneNode(true)
                  var c = e.children
                  var comp = comparisons[i]
                  c[0].innerHTML = comp.unit
                  c[1].innerHTML = Math.round(cost / comp.cost)
                  view.appendChild(e)
                }
                
              break;
            }
          }
        }
        
        microAjax("data.json", function (res) {
          var json = JSON.parse(res)
          projects = json.projects
          comparisons = json.comparisons
          
          // Store menu data
          var menu = document.getElementById("menu");
          var menuElement = menu.children[0];
          for (var i in projects) {
            var x = i; 
            var e = menuElement.cloneNode(true);
            var p = projects[i];
            e.className = e.className.replace("btn-primary", "btn-default");
            e.innerHTML = p.name;
            e.title = p.description;
            e.onclick = function() { obj.setProject(x); }
            menu.appendChild(e);
          }
          
          // Store table data
          dataElement = view.children[0]
          view.removeChild(dataElement)
          
          obj.setProject(0);
        });
        
        return obj
      }());
    </script>

  </body>
</html>
